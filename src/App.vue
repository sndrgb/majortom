<template>
    <div id="app">
        <transition name="fade">
            <div ref="intro" class="intro" v-if="!show">
                <h2>
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256.2 152.5">
                        <g class="major">
                            <path d="M198 1.3c.3.5.5 1.1.4 1.7 0 .6-.2 1.2-.6 1.7-1.3 1.8-2.8 3.5-4.3 5.2s-2.9 3.4-4.3 5.1c-1.9 2.4-3.9 4.8-5.8 7.3-1.9 2.4-3.8 4.9-5.7 7.4-3.6 4.7-7.1 9.5-10.6 14.3-3.5 4.8-6.8 9.8-10 14.9-1.6 2.5-3.2 5.1-4.7 7.7-1.5 2.6-2.8 5.3-4 8.1-.5 1.2-.9 2.5-1.3 3.7-.4 1.3-.7 2.6-.9 3.9-.1.1-.1.4-.1.8s-.1.7-.2.7c-.2.1-.4-.1-.5-.4-.1-.4-.2-.6-.3-.7-.3-.6-.4-1.3-.5-2-.1-.7-.1-1.5 0-2.2.3-2.9.9-5.7 1.9-8.4 1-2.7 2.1-5.3 3.3-7.9 1.2-2.6 2.6-5.2 4-7.6 1.4-2.5 2.9-4.9 4.4-7.3 1.7-2.7 3.6-5.6 5.7-8.6s4.2-5.9 6.5-8.9c2.2-3 4.4-5.9 6.7-8.7s4.3-5.5 6.3-8c-2.1 1.4-4.3 3-6.6 4.7-2.3 1.7-4.7 3.5-7.1 5.3-2.4 1.8-4.8 3.6-7.1 5.3-2.3 1.8-4.5 3.4-6.5 4.8-5 3.7-9.9 7.4-14.7 11.3-4.8 3.8-9.4 7.9-13.8 12.2-2 1.9-3.9 3.8-5.7 5.9-1.8 2-3.4 4.2-4.8 6.6-.2.3-.3.5-.5.8-.2.3-.3.5-.4.8-.3.4-.6.3-.7-.2-.1-.5-.2-.9-.1-1.2.3-1.8.7-3.5 1.3-5.2.6-1.7 1.2-3.4 1.7-5.1 2.3-6.2 4.9-12.1 7.8-17.9s6-11.6 9.1-17.7c-9.3 9-18.4 18.2-27.2 27.5-8.5 9.3-17.1 18.8-25.5 28.7l-3 3.3-3 3.3c-.3.3-.6.7-1.1 1.2l-1.4 1.4c-.5.5-.9.8-1.2 1.2-.3.3-.5.5-.6.5-.1 0-.1-.2 0-.5s.3-.7.5-1.1.4-.8.7-1.2c.3-.4.5-.8.6-1 1.2-1.9 2.4-3.7 3.7-5.5 1.3-1.8 2.6-3.6 4-5.5 3.8-5.1 7.6-10.1 11.7-15 4-4.9 8.2-9.7 12.5-14.4 8.6-9.4 17.6-18.5 27-27.3 1.2-1.2 2.4-2.3 3.6-3.4 1.2-1.1 2.4-2.1 3.6-3.2.5-.4 1-.7 1.4-1 .5-.3 1.1-.4 1.8-.3.6.2 1.1.5 1.5 1 .4.5.6 1 .6 1.6 0 .4-.1.8-.2 1.1-.2.3-.3.6-.5.9-1.3 2.5-2.6 5-4 7.5s-2.7 5-4.1 7.6c-2.8 5.2-5.7 10.4-8.4 15.7-2.8 5.3-5.5 10.6-8.2 16 2.4-3.6 5.1-7 8.2-10.1 3.1-3.1 6.2-6.2 9.4-9.1 7.2-6.6 14.7-12.8 22.3-18.7 7.6-5.8 15.4-11.6 23.4-17.2 1.6-1.2 3.2-2.3 5-3.4 1.8-1.1 3.5-2.2 5.1-3.5.5-.3 1.1-.5 1.7-.6.5-.1 1-.1 1.5.2.6.2 1 .6 1.3 1.1zM196.1 55.4c0 .1-.1.2-.2.4-.6.6-1.3 1.3-2.1 1.8-.7.6-1.5 1.2-2.3 1.8-2.5 1.8-5.1 3.8-8 6.2-.9.6-1.7 1.3-2.5 2.1-.7.7-1.5 1.5-2.4 2.2-.2.2-.6.4-1 .8-.5.4-.7.6-.8.7-.4.4-1 .6-1.7.4-.7-.1-1.2-.4-1.6-.9-.4-.5-.6-1.1-.4-1.8.1-.6.3-1.3.6-1.9.6-1.3 1.2-2.6 1.9-3.8.7-1.2 1.4-2.4 2.2-3.6-.8.7-1.6 1.4-2.3 2.1-.8.7-1.5 1.3-2.3 1.9-1.2 1.1-2.4 2.1-3.5 3.1s-2.4 1.9-3.7 2.9c-.3.3-.7.6-1.2.9-.5.3-.9.6-1.4.8-.5.2-.9.3-1.4.3-.5 0-.9-.2-1.4-.5-.6-.4-.9-1-.9-1.8s.1-1.4.3-2c.5-1.9 1.4-3.7 2.6-5.6 1.2-1.8 2.5-3.5 3.7-5.1 1.3-1.5 2.5-2.8 3.5-3.8 1.1-1 1.8-1.7 2.1-1.9 1-.9 2.1-1.9 3.4-2.8 1.3-1 2.7-1.8 4.2-2.6s3-1.4 4.6-1.9c1.6-.5 3.1-.7 4.5-.7.7 0 1.6.1 2.5.3.9.2 1.6.6 2 1.2.1.1.1.2.2.4s.1.3-.1.2c-1.4-.4-2.8-.4-4.2-.2-1.3.3-2.7.7-3.9 1.4-1.3.6-2.5 1.4-3.7 2.4-1.2.9-2.3 1.8-3.5 2.7-1 .8-2 1.8-3.1 2.9-1.1 1.1-2.2 2.4-3.3 3.7-1.1 1.4-2.1 2.8-3.1 4.3s-1.9 3.1-2.6 4.7c2.1-1.4 4.4-3 6.8-4.8 2.4-1.8 4.7-3.5 7-5.2 1.1-.9 2.2-1.8 3.5-2.7 1.3-.9 2.5-1.8 3.7-2.8.3-.3.7-.6 1.2-1s1-.8 1.5-1.1c.5-.3 1-.7 1.4-1s.7-.4.8-.4c.4-.1.8 0 1 .3.3.3.4.6.2 1 0 .1-.1.3-.3.6-.2.3-.5.6-.7.9-.3.3-.5.6-.8.9-.2.3-.4.5-.4.6-.9 1-1.8 2.1-2.9 3.4-1 1.3-2.1 2.5-3.1 3.7-1 1.2-1.8 2.3-2.6 3.2-.7.9-1.2 1.5-1.4 1.8.5-.3 1.1-.8 2-1.3.8-.5 1.5-1 2-1.4 1.5-1 3-2 4.6-2.9l4.8-2.7c.1-.1.4-.3.8-.5.8-.4 1.1-.4 1.2-.3z"/>
                            <path d="M212.6 44.1c.3.2.1.9-.6 2.1-.6 1.2-1.5 2.7-2.7 4.5-1.2 1.8-2.4 3.7-3.9 5.8-1.4 2.1-2.8 4.1-4.1 6-1.3 1.9-2.5 3.5-3.5 4.9s-1.6 2.2-1.8 2.5c-4.1 5.9-8.5 11.6-13.2 17-4.7 5.4-9.9 10.3-15.6 14.8-2.7 2.1-5.6 4.1-8.6 5.9-3 1.8-6.1 3.3-9.4 4.5-1.4.5-2.9 1-4.5 1.3-1.6.4-3.1.6-4.7.7h-1c-.4 0-.7 0-1-.1-.4-.1-.5-.2-.2-.4s.5-.3.7-.3c.7-.3 1.4-.5 2.1-.7.7-.2 1.4-.4 2.1-.7 3.3-1.2 6.4-2.7 9.3-4.4 3-1.8 5.8-3.7 8.5-5.8 2.7-2.1 5.3-4.4 7.8-6.8 2.5-2.4 4.9-4.9 7.2-7.4 1.2-1.3 2.4-2.8 3.8-4.5 1.3-1.7 2.7-3.5 4.1-5.4 1.4-1.9 2.9-3.8 4.3-5.7 1.4-2 2.8-3.8 4.1-5.7 3.1-4.3 6.2-8.7 9.3-13.3-2.3 1.6-4.6 3.2-6.9 4.6-2.3 1.5-4.7 3-7.1 4.5-.2.1-.5.3-.9.4-.4.2-.6.2-.7.1 0-.1.1-.2.2-.4.6-.7 1.3-1.3 2.1-1.9.7-.6 1.5-1.2 2.3-1.8.3-.2.9-.7 2-1.6 1.1-.9 2.4-1.9 3.9-3s3.2-2.3 4.9-3.6c1.7-1.3 3.4-2.4 5-3.4s3-1.8 4.2-2.3c1.2-.5 2-.7 2.5-.4zm5.4-13.7c.2.4.2.9 0 1.3-.1.5-.4.9-.6 1.3s-.6.8-1 1.1c-.4.3-.8.6-1.1.7-.3.2-.7.3-1.2.4-.5.1-.9.1-1.3.1s-.8-.1-1.2-.3c-.4-.2-.6-.5-.8-.9-.3-.9-.2-1.7.3-2.5s1.2-1.4 1.8-1.7c.3-.2.7-.4 1.2-.5.5-.1 1-.2 1.5-.2s1 .1 1.4.2c.5.2.8.6 1 1zM233.8 43.2c.7.2 1.3.6 1.7 1.1.4.5.6.7.6.7-.2-.1-.4-.1-.7-.2-.3-.1-.7-.1-1.2-.2-1-.1-2 0-3.1.3s-2 .7-3.1 1.3c-1 .6-2.1 1.2-3.1 2s-2.1 1.6-3.2 2.5c-.5.4-1.4 1.3-2.7 2.6-1.3 1.3-2.6 2.8-3.9 4.5-1.3 1.7-2.5 3.5-3.5 5.3-1 1.8-1.5 3.5-1.5 5 1.6-.2 3.4-1 5.5-2.3 2.1-1.3 4.1-2.9 6.1-4.7 2-1.8 3.8-3.7 5.4-5.7 1.6-2 2.7-3.8 3.3-5.5.2-.5.3-1.1.4-1.6.1-.5 0-1.1-.2-1.6-.1-.3-.2-.5-.2-.6.1-.2.3-.1.7.4.4.5.7 1 .8 1.6.6 2.4.3 4.9-.9 7.5-1.3 2.6-3 5-5.2 7.2s-4.7 4.1-7.3 5.7c-2.7 1.6-5.1 2.7-7.2 3.2-1.4.4-2.8.4-4.1 0-1.1-.4-1.8-1.2-2.3-2.3-.4-1.1-.6-2.1-.4-3.2.2-1.4.6-2.7 1.2-4 .6-1.3 1.3-2.5 2.1-3.7.7-1.1 1.7-2.3 2.8-3.5s2.4-2.6 3.8-3.8c1.4-1.3 2.9-2.5 4.6-3.6 1.6-1.2 3.3-2.1 4.9-2.9 1.7-.7 3.3-1.3 4.9-1.6 1.9-.4 3.5-.4 5 .1z"/>
                            <path d="M256.2 55c.1.1-.2.4-.6.8-.5.4-1 .9-1.7 1.5-.6.6-1.3 1.1-1.9 1.6-.6.5-1.1.9-1.3 1.1-.9.6-1.7 1.3-2.5 2s-1.7 1.3-2.5 2c-1.3 1.1-2.5 2.1-3.7 3.2s-2.4 2.2-3.5 3.4l-1.1 1.1c-.4.3-.7.7-1.2.9-.8.4-1.5.5-2.3.1-.8-.3-1.2-1-1.3-1.9-.1-.9.1-1.7.5-2.6.5-.9.9-1.6 1.3-2.3 1.2-2 2.5-4 3.9-5.9 1.3-1.9 2.6-3.9 3.8-5.9.2-.3.3-.7.1-1.2-.1-.5-.3-.9-.4-1.4-1.8 1.6-3.8 3.3-6 4.9-2.3 1.7-4.4 3.2-6.4 4.5-2 1.3-3.7 2.4-5.1 3.1-1.4.7-2.2 1-2.3.9-.1-.1.4-.5 1.2-1.2.9-.7 2-1.6 3.3-2.7 1.3-1.1 2.8-2.3 4.4-3.5 1.6-1.3 3.1-2.6 4.5-3.9 1.4-1.3 2.6-2.5 3.7-3.6 1-1.1 1.6-2.1 1.8-2.8-.1-.9 0-1.9 0-3.1.1-1.1.5-2.1 1.2-3 .6-.7 1.4-1 2.3-1 .9 0 1.6.5 2 1.4.4 1 .5 1.9.1 2.8-.4.9-.8 1.7-1.2 2.5-.1.3-.2.5-.3.7-.1.2-.2.5-.2.8.1.7.3 1.5.6 2.1s.6 1.4 1 2.1c.4 1.1.5 2.1.4 3-.2.9-.6 1.9-1.3 2.8-.6.9-1.3 1.8-2 2.8s-1.4 1.9-2 2.8c1.2-.8 2.4-1.6 3.6-2.5 1.2-.9 2.4-1.7 3.6-2.5.2-.1.6-.4 1.4-.9.8-.5 1.6-1 2.5-1.5.9-.5 1.7-1 2.4-1.4.7-.2 1.1-.3 1.2-.1z"/>
                        </g>
                        <g class="tom">
                            <path d="M69.4 94.6H43.6v56.6H25.8V94.6H0V78.3h69.4v16.3zM147.7 114.7c0 20.8-16.9 37.7-37.6 37.7-20.9 0-37.6-16.9-37.6-37.7C72.5 94 89.2 77 110.1 77c20.7 0 37.6 17.1 37.6 37.7zm-59.2 0c0 11.9 9.6 21.4 21.5 21.4 11.7 0 21.3-9.5 21.3-21.4 0-11.8-9.6-21.3-21.3-21.3-11.8 0-21.5 9.5-21.5 21.3zM249.1 151.2h-17.7V114L214 151.2h-19.6L176.9 114v37.2h-17.6V78.3h19.5l25.4 53.5 25.3-53.5h19.6v72.9z"/>
                        </g>
                    </svg>
                </h2>
                <button @click="play">
                    Play
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24">
                    <path d="M3 22V2l18 10L3 22z"/></svg>
                </button>
            </div>
        </transition>
        <div class="top">
            <p>{{msg}}</p>
            <p>{{right}}</p>
        </div>
        <transition name="fade">
            <div v-if="show">
                <div class="mid" v-if="status === 'gameover' || status === 'paused'">
                    <p>Game Over</p>
                    <button @click="replay">
                        Replay
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><path d="M12 0c3.31 0 6.29 1.353 8.46 3.522l2.48-2.48L24 8.382l-7.437-.965 2.49-2.49C17.242 3.122 14.752 2 12 2 6.486 2 2 6.486 2 12s4.486 10 10 10c3.872 0 7.23-2.216 8.89-5.443l1.717 1.046C20.595 21.406 16.602 24 12 24 5.373 24 0 18.627 0 12S5.373 0 12 0z"/></svg>
                    </button>
                </div>
                <div class="bottom" v-if="status === 'playing'">
                    <p>level <span>{{Math.floor(distance / 1000)}}</span></p>
                    <p>distance <span>{{distance}}</span></p>
                </div>
            </div>
        </transition>
    </div>
</template>

<script>
import loop from 'raf-loop';
import Game from './Game'

export default {
    name: 'app',
    data() {
        return {
            msg: 'Digital Design Days 2017.',
            right: 'by Alessandro Rigobello @sndrgb',
            distance: 0,
            level: 0,
            show: false,
            status: 'paused',
        }
    },

    mounted() {
        this.game = new Game();
        this.game.resetProps();
        this.loop = loop(this.render);
        // start rendering
        this.loop.start();
    },

    methods: {
        render() {
            //if (this.game.game.stop) this.loop.stop();
            //console.log(this.game.game.stop);
            this.game.render();
            this.distance = Math.floor(this.game.game.distance);
            this.level = this.game.game.level;
            this.status = this.game.game.status;
        },

        replay() {
            this.game.reset();
        },

        play() {
            this.show = true;
            this.game.reset('playing');
        }
    }
}
</script>

<style lang="scss">
@import url('https://fonts.googleapis.com/css?family=Lato:100,300,400,700,900');

$main-color: #2c3e50;

#app {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  margin: 0;
  bottom: 0;
  font-family: 'Lato', sans-serif;
  font-weight: 300;

  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;

  color: $main-color;
  margin: 40px;
  z-index: 20;
}

.intro {
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
    z-index: 10;
    display: flex;
    flex-flow: column;
    align-items: center;
    justify-content: center;
    text-align: center;

    > h2 svg {
        width: 350px;
        margin-bottom: 25px;
    }

    /*#252525*/
    /*#46ffdd*/
    /*#8367d8*/

    .major {
        fill: #252525;
    }

    .tom {
        fill: #8367d8;
    }

    > p {
        margin: 5px;
        line-height: 25px;
    }

    > button {
        &:hover {
            svg {
                transform: translateX(2px);
            }
        }
    }
}

p {
    margin: 0;
}

canvas {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  margin: 0;
  bottom: 0;
}

.top {
    display: flex;
    width: 100%;
    position: absolute;
    left: 0;
    right: 0;
    top: 0;
    justify-content: space-between;
    visibility: visible;
}

.mid {
    position: absolute;
    left: 0;
    right: 0;
    bottom: 0;
    top: 0;
    display: flex;
    flex-flow: column;
    align-items: center;
    justify-content: center;
    visibility: visible;

    p {
        font-size: 2.2rem;
        text-transform: uppercase;
        margin-bottom: 2rem;
    }
}

.bottom {
    position: absolute;
    left: 0;
    right: 0;
    bottom: 0;
    display: flex;
    width: 100%;
    justify-content: flex-end;
    flex-flow: column;
    visibility: visible;

    p {
        text-align: right;
        margin-top: 2rem;
    }

    span {
        font-size: 3rem;
        display: block;
    }
}


button {
    background: $main-color;
    color: white;
    padding: 10px 20px;
    border-radius: 30px;
    font-size: 1rem;
    display: flex;
    align-items: center;
    outline: none;
    border: none;
    cursor: pointer;
    transition: all 0.2s;

    &:hover {
        background: lighten($main-color, 10%);

        svg {
            transform: rotate(180deg);
        }
    }

    svg {
        margin-left: 10px;
        fill: white;
        transition: all 0.2s;
    }
}

.fade-enter-active, .fade-leave-active {
  transition: opacity 1s
}
.fade-enter, .fade-leave-to /* .fade-leave-active in <2.1.8 */ {
  opacity: 0
}

/*252525*/
/*#46ffdd*/
/*#8367d8*/
</style>
